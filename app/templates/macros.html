{% macro info_chrono_station() %}
    <div><h1 id="clock">--:--</h1></div>

    <audio class="audios" id="myaudio" controls preload="none">
       <source src="" type="audio/mpeg">
    </audio>
{% endmacro %}

{% macro info_chrono_admin(rounds) %}

    {% for r in rounds %}
        <div><h1>Rueda {{ r.id }} (vuelta <span id="vuelta{{ r.id }}"></span>): <span id="clock{{ r.id }}">--:--</span></h1></div>
    {% endfor %}

{% endmacro %}

{% macro client_eval_socket(chrono_route, station_id, id_round) %}

    $('#myaudio').hide();

    /*** SOCKETS ***/

    var socket = io.connect('{{ chrono_route }}');

    socket.on('connect', function () {
        console.log('Estación {{ station_id }}: conectada a rueda {{ id_round }}')
    });

    socket.on('end_round', function(msg) {
        $('#clock').css("color", "green").show('slow');
        console.log(msg.data)
    });

    socket.on('init_stage', function(msg) {
        $('#clock').fadeOut('fast').fadeIn('fast');
    });

    socket.on('evento', function(msg) {
        if (jQuery.inArray({{ station_id }}+"", msg.target.split(",")) >= 0) {
            console.log("[" + msg.stage + "] " + msg.data + " => " + msg.target)
            $("#myaudio").attr('src', '{{ url_for('static', filename='sounds/') }}'+msg.sound)
            $('#myaudio').trigger('play');
        }
    });

    socket.on('aborted', function(msg) {
        $('#clock').css("color", "red");
        $('#clock').text("EVALUACIÓN ABORTADA");
    });

    socket.on('tic_tac', function(msg) {
        $('#clock').text(msg.stage + " " + msg.minutes + ":" + msg.seconds);

        if (msg.stopped == 'S') {
            $('#clock').css("color", "red");
            console.log("[" + msg.minutes + ":" + msg.seconds + "] Crono parado");
        }
        else
            $('#clock').css("color", "black");
    });

    /*** END SOCKETS ***/
{% endmacro %}